<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SERA AI</title>

  <style>
    body {
      margin: 0;
      background: #ffffff;
      font-family: "Tahoma", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #000;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    /* Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ */
    header {
      border-bottom: 1px solid #eee;
      padding: 14px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 24px;
      font-weight: bold;
      color: #000;
    }

    /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ø§Øª */
    .chat-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 900px;
      width: 100%;
      margin: 0 auto;
      padding: 10px 16px 0;
      box-sizing: border-box;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 10px 0 5px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª */
    .bot-message {
      align-self: flex-start;
      background: #ffffff;
      border: 1px solid #e1e1e1;
      border-radius: 14px;
      padding: 12px 16px;
      max-width: 80%;
      font-size: 16px;
      line-height: 1.7;
      white-space: pre-line; /* ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„ØªÙ†Ù‚ÙŠØ· */
    }

    /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
    .user-message {
      align-self: flex-end;
      background: #f1f1f1;
      border-radius: 14px;
      padding: 12px 16px;
      max-width: 80%;
      font-size: 16px;
      line-height: 1.7;
      white-space: pre-line;
    }

    /* Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø³Ø±ÙŠØ¹Ø© */
    .quick-topics {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 8px;
    }

    .quick-topics button {
      border: 1px solid #ddd;
      background: #fafafa;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
    }

    .quick-topics button:hover {
      background: #f0f0f0;
    }

    /* Ù…Ø¤Ø´Ø± Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙƒØªØ§Ø¨Ø© */
    .typing {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 13px;
      color: #777;
      margin-top: 4px;
    }

    .dot {
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: #777;
      animation: blink 1.4s infinite;
    }

    .dot:nth-child(2) { animation-delay: 0.2s; }
    .dot:nth-child(3) { animation-delay: 0.4s; }

    @keyframes blink {
      0% { opacity: 0.2; }
      50% { opacity: 1; }
      100% { opacity: 0.2; }
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .input-area {
      border-top: 1px solid #eee;
      padding: 10px 16px 14px;
      display: flex;
      align-items: center;
      gap: 10px;
      max-width: 900px;
      width: 100%;
      margin: 0 auto;
      box-sizing: border-box;
      background: #fff;
    }

    .input-area input {
      flex: 1;
      padding: 12px;
      border-radius: 999px;
      border: 1px solid #ccc;
      font-size: 15px;
      outline: none;
    }

    .input-area input:focus {
      border-color: #000;
    }

    /* Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ Ø£Ø³ÙˆØ¯ Ø¯Ø§Ø¦Ø±ÙŠ */
    .send-btn {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      border: none;
      background: #000;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: background 0.2s;
    }

    .send-btn:hover {
      background: #333;
    }

    /* Ø²Ø± Ù…Ø§ÙŠÙƒØ±ÙˆÙÙˆÙ† (Ù…Ø³ØªÙ‚Ø¨Ù„Ù‹Ø§ Ù„Ùˆ Ø­Ø§Ø¨ Ù†ÙØ¹Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ) */
    .mic-btn {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      border: none;
      background: #007aff;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: background 0.2s;
    }

    .mic-btn:hover {
      background: #0060c0;
    }

    @media (max-width: 600px) {
      .bot-message,
      .user-message {
        max-width: 90%;
        font-size: 15px;
      }
    }
  </style>
</head>

<body>

  <header>
    <h1>SERA AI ğŸ–¤</h1>
  </header>

  <div class="chat-wrapper">
    <div class="messages" id="messages">
      <!-- Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ÙŠØ© Ø£ÙˆÙ„Ù‰ -->
      <div class="bot-message">
        Ø£Ù‡Ù„Ø§Ù‹ ğŸ‘‹  
        Ø£Ù†Ø§ SERA AIØŒ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„Ø¨Ø´Ø±Ø© ÙˆØ§Ù„Ø´Ø¹Ø± ÙˆØ§Ù„Ø¬Ø³Ù….  
        Ø§ÙƒØªØ¨ Ù…Ø´ÙƒÙ„ØªÙƒ Ø£Ùˆ Ù‡Ø¯ÙÙƒØŒ Ø£Ùˆ Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ø¨Ø§Ù„Ø£Ø³ÙÙ„.
      </div>

      <div class="quick-topics">
        <button onclick="quickAsk('Ø§Ø¨ØºÙ‰ Ø±ÙˆØªÙŠÙ† ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø¨Ø´Ø±Ø© Ø§Ù„Ù…Ø®ØªÙ„Ø·Ø©')">
          Ø±ÙˆØªÙŠÙ† Ù„Ù„Ø¨Ø´Ø±Ø© Ø§Ù„Ù…Ø®ØªÙ„Ø·Ø©
        </button>
        <button onclick="quickAsk('Ø£Ø¹Ø§Ù†ÙŠ Ù…Ù† Ø­Ø¨ Ø´Ø¨Ø§Ø¨ ÙÙŠ Ø§Ù„ÙˆØ¬Ù‡ØŒ ÙƒÙŠÙ Ø£ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ØŸ')">
          Ø­Ø¨ Ø§Ù„Ø´Ø¨Ø§Ø¨
        </button>
        <button onclick="quickAsk('Ø§Ø¨ØºÙ‰ Ø±ÙˆØªÙŠÙ† Ù„ØªÙØªÙŠØ­ ÙˆØªÙˆØ­ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„Ø¬Ø³Ù…')">
          ØªÙˆØ­ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„Ø¬Ø³Ù…
        </button>
        <button onclick="quickAsk('Ø´Ø¹Ø±ÙŠ Ø¬Ø§Ù ÙˆÙŠØªØ³Ø§Ù‚Ø·ØŒ Ø§Ø¨ØºÙ‰ Ø±ÙˆØªÙŠÙ† Ø¹Ù†Ø§ÙŠØ© ÙƒØ§Ù…Ù„')">
          Ø±ÙˆØªÙŠÙ† Ù„Ù„Ø´Ø¹Ø± Ø§Ù„Ø¬Ø§Ù
        </button>
      </div>
    </div>

    <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© -->
    <div id="typing" class="typing" style="display:none;">
      SERA AI ÙŠÙƒØªØ¨
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </div>

  <div class="input-area">
    <button class="mic-btn" onclick="startMic()">ğŸ¤</button>
    <input
      type="text"
      id="userInput"
      placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§ ÙˆØ§Ø¶ØºØ· Ø¥Ø±Ø³Ø§Ù„ Ø£Ùˆ Ø¥Ù†ØªØ±..."
    />
    <button class="send-btn" onclick="sendMessage()">â¤</button>
  </div>

  <script>
    const backendURL = "https://sera-ai-backend-qhrd.onrender.com/ask";

    function addMessage(text, sender) {
      const messages = document.getElementById("messages");
      const msg = document.createElement("div");
      msg.className = sender === "user" ? "user-message" : "bot-message";
      msg.textContent = text;
      messages.appendChild(msg);
      messages.scrollTop = messages.scrollHeight;
    }

    function showTyping() {
      const t = document.getElementById("typing");
      t.style.display = "flex";
    }

    function hideTyping() {
      const t = document.getElementById("typing");
      t.style.display = "none";
    }

    async function sendMessage() {
      const input = document.getElementById("userInput");
      const text = input.value.trim();
      if (!text) return;

      addMessage(text, "user");
      input.value = "";
      input.focus();

      showTyping();

      try {
        const res = await fetch(backendURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        hideTyping();

        const reply = data.reply || "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
        addMessage(reply, "bot");
      } catch (e) {
        hideTyping();
        addMessage("ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±. ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø®Ø¯Ù…Ø© ÙÙŠ Render ØªØ¹Ù…Ù„.", "bot");
      }
    }

    function quickAsk(text) {
      const input = document.getElementById("userInput");
      input.value = text;
      sendMessage();
    }

    // Ø¯Ø¹Ù… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¥Ù†ØªØ± Ù„Ù„Ø¥Ø±Ø³Ø§Ù„
    document.getElementById("userInput").addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        e.preventDefault();
        sendMessage();
      }
    });

    // Ø²Ø± Ø§Ù„Ù…Ø§ÙŠÙƒØ±ÙˆÙÙˆÙ† (Ø¨Ø³ÙŠØ· ÙƒØ¨Ø¯Ø§ÙŠØ©)
    function startMic() {
      if (!("webkitSpeechRecognition" in window)) {
        alert("Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙˆØª Ù…Ø¨Ø§Ø´Ø±Ø©.");
        return;
      }
      const rec = new webkitSpeechRecognition();
      rec.lang = "ar-SA";
      rec.start();
      rec.onresult = function (event) {
        const transcript = event.results[0][0].transcript;
        const input = document.getElementById("userInput");
        input.value = transcript;
        input.focus();
      };
    }
  </script>

</body>
</html>